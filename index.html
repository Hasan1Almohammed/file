<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø±ÙØ¹ ÙˆÙ…Ø´Ø§Ø±ÙƒØ© Ù…Ù„ÙØ§Øª</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
/* ===== Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ© ===== */
* { box-sizing: border-box; margin:0; padding:0; }
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    padding: 20px;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    transition: background 0.3s, color 0.3s;
}

/* ===== Dark / Light Mode ===== */
body.dark {
    background: linear-gradient(to right, #0f2027, #203a43, #2c5364);
    color: #fff;
}
body.light {
    background: #f0f0f0;
    color: #111;
}

/* ===== Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ===== */
h2 { margin-bottom: 15px; text-align:center; transition: color 0.3s; }
body.dark h2 { color: #ffcc00; }
body.light h2 { color: #333; }

/* ===== Ù…Ù„Ù Card ===== */
#files { margin-top:20px; display:flex; flex-direction:column; gap:12px; flex:1; }
.file {
    padding:15px; border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.2);
    display:flex; flex-direction:column; gap:10px;
}
body.dark .file { background: rgba(255,255,255,0.05); }
body.light .file { background: #fff; }

.file b { word-break: break-word; }
body.dark .file b { color:#ffdd57; }
body.light .file b { color:#0077cc; }

/* ===== Ø§Ù„Ø£Ø²Ø±Ø§Ø± ===== */
button {
    padding: 16px 12px; border:none; border-radius:24px;
    cursor:pointer; font-weight:bold;padding: 5px;
}
.btn-upload { background:#2196f3; color:#fff; }
.btn-copy { background:#4caf50; color:#fff; }
.btn-delete { background:#f44336; color:#fff; }
.btn-mode {
    background:#ff9800; color:#fff;
    position:fixed; top:20px; right:20px;
}

/* ===== Ø±ÙˆØ§Ø¨Ø· Ù…Ù„ÙØ§Øª ===== */
.file-actions { display:flex; flex-wrap:wrap; gap:10px; }

/* ===== Input file ===== */
input[type="file"] {
    padding: 8px;
    border-radius: 8px;
    border: 1px solid #ccc;
    width: 100%;
}
body.dark input[type="file"] {
    background: rgba(255,255,255,0.05);
    color:#fff; border:1px solid #555;
}

/* ===== Footer ===== */
footer {
    margin-top: 20px;
    padding: 15px 0;
    text-align:center;
    font-size:14px;
    opacity:0.7;
}
</style>
</head>
<body>

<button class="btn-mode" onclick="toggleMode()">ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ ğŸŒ™/â˜€ï¸</button>

<h2>Ø±ÙØ¹ Ù…Ù„Ù (Ø£ÙŠ Ù†ÙˆØ¹)</h2>
<input type="file" id="fileInput">
    <br>
<button class="btn-upload" onclick="uploadFile()">Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù</button>
<br>
<hr color= #ffcc00;>

<h2>Ø§Ù„Ù…Ù„ÙØ§Øª</h2>
<div id="files"></div>

<footer>
    Developer by Hasan | Â© 2026
</footer>

<script>
const SUPABASE_URL = "https://tlmkjawlfszsxtdszvol.supabase.co";
const SUPABASE_ANON_KEY = "sb_publishable_qYUNJQIlY_w12AXUwSAW_Q_l89ThqTB";
const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

// Dark / Light
const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
document.body.classList.add(prefersDark ? 'dark' : 'light');
function toggleMode(){
    document.body.classList.toggle('dark');
    document.body.classList.toggle('light');
}

// Ø±ÙØ¹
async function uploadFile() {
    const file = document.getElementById("fileInput").files[0];
    if(!file) return alert("Ø§Ø®ØªØ± Ù…Ù„Ù");
    if(file.size > 50*1024*1024) return alert("Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: 50MB");

    const fileName = crypto.randomUUID()+"_"+file.name;
    const { error } = await supabaseClient.storage
        .from("uploads")
        .upload(fileName, file);

    if(error) return alert("ÙØ´Ù„ Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù");
    loadFiles();
}

// Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„ÙØ§Øª
async function loadFiles() {
    const { data } = await supabaseClient.storage.from("uploads").list("");
    const box = document.getElementById("files");
    box.innerHTML = "";

    for(let f of data){
        const link = `${location.origin}/file.html#${f.name}`;
        const publicUrl = supabaseClient.storage
            .from("uploads")
            .getPublicUrl(f.name).data.publicUrl;

        box.innerHTML += `
        <div class="file">
            <b>${f.name}</b>
            <div class="file-actions">
                <a href="${link}" target="_blank">
                    <button class="btn-copy">ÙØªØ­ Ø§Ù„Ù…Ù„Ù</button>
                </a>
                <button class="btn-copy" onclick="copyLink('${link}')">Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
                <button class="btn-copy" onclick="forceDownload('${publicUrl}','${f.name}')">
                    ØªÙ†Ø²ÙŠÙ„
                </button>
                <button class="btn-delete" onclick="deleteFile('${f.name}')">Ø­Ø°Ù</button>
            </div>
        </div>`;
    }
}

// ğŸ”½ ØªÙ†Ø²ÙŠÙ„ Ø¥Ø¬Ø¨Ø§Ø±ÙŠ (Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ­ÙŠØ¯)
async function forceDownload(url, filename){
    const res = await fetch(url);
    const blob = await res.blob();
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(a.href);
}

// Ø­Ø°Ù
async function deleteFile(name) {
    await supabaseClient.storage.from("uploads").remove([name]);
    loadFiles();
}

// Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·
function copyLink(text){
    navigator.clipboard.writeText(text);
    alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·");
}

loadFiles();
</script>

</body>
</html>
