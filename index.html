<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø±ÙØ¹ ÙˆÙ…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù„ÙØ§Øª</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
*{box-sizing:border-box;margin:0;padding:0}
body{
 font-family:Segoe UI,Tahoma;
 min-height:100vh;
 display:flex;
 flex-direction:column;
 padding:20px;
 transition:.3s;
}
body.dark{
 background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
 color:#fff;
}
body.light{
 background:#f3f3f3;
 color:#111;
}

h2{text-align:center;margin:15px 0}

.container{max-width:900px;margin:auto;width:100%}

input[type=file]{
 width:100%;
 padding:12px;
 border-radius:10px;
 margin-bottom:10px;
 border:none;
}

button{
 padding:10px 14px;
 border:none;
 border-radius:10px;
 cursor:pointer;
 font-weight:bold;
 transition:.3s;
}
button:hover{transform:scale(1.05)}

.btn-upload{background:#2196f3;color:#fff;width:100%}
.btn-copy{background:#4caf50;color:#fff}
.btn-delete{background:#f44336;color:#fff}
.btn-download{background:#ff9800;color:#fff}
.btn-mode{
 position:fixed;
 top:15px;
 right:15px;
 background:#000;
 color:#fff;
}

.file{
 background:rgba(255,255,255,.08);
 padding:15px;
 border-radius:14px;
 margin-top:15px;
 box-shadow:0 4px 15px rgba(0,0,0,.3);
}

.actions{
 display:flex;
 flex-wrap:wrap;
 gap:10px;
 margin-top:10px;
}

.progress{
 width:100%;
 height:8px;
 background:#555;
 border-radius:10px;
 overflow:hidden;
 margin-top:10px;
 display:none;
}
.progress div{
 height:100%;
 width:0;
 background:#00e676;
 transition:.3s;
}

footer{
 text-align:center;
 margin-top:auto;
 opacity:.7;
 padding:15px;
}

@media(max-width:600px){
 .actions button{width:100%}
}
</style>
</head>

<body>
<button class="btn-mode" onclick="toggleMode()">ğŸŒ™ / â˜€ï¸</button>

<div class="container">
<h2>Ø±ÙØ¹ Ù…Ù„Ù (Ø­ØªÙ‰ 50MB)</h2>

<input type="file" id="fileInput">
<button class="btn-upload" onclick="uploadFile()">Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù</button>

<div class="progress" id="uploadProgress"><div></div></div>

<h2>Ø§Ù„Ù…Ù„ÙØ§Øª</h2>
<div id="files"></div>
</div>

<footer>Developer by Hasan | Â© 2026</footer>

<script>
const supabase=supabasejs.createClient(
 "https://tlmkjawlfszsxtdszvol.supabase.co",
 "sb_publishable_qYUNJQIlY_w12AXUwSAW_Q_l89ThqTB"
);

// Dark / Light
document.body.classList.add(
 matchMedia('(prefers-color-scheme:dark)').matches?'dark':'light'
);
function toggleMode(){
 document.body.classList.toggle("dark");
 document.body.classList.toggle("light");
}

// Ø±ÙØ¹ Ù…Ø¹ Progress
async function uploadFile(){
 const file=document.getElementById("fileInput").files[0];
 if(!file) return alert("Ø§Ø®ØªØ± Ù…Ù„Ù");
 if(file.size>50*1024*1024) return alert("Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 50MB");

 const bar=document.getElementById("uploadProgress");
 const fill=bar.firstElementChild;
 bar.style.display="block";
 fill.style.width="0%";

 const name=crypto.randomUUID()+"_"+file.name;

 await supabase.storage.from("uploads")
 .upload(name,file,{
  onUploadProgress:p=>{
   fill.style.width=Math.round((p.loaded/p.total)*100)+"%";
  }
 });

 bar.style.display="none";
 loadFiles();
}

// Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„ÙØ§Øª
async function loadFiles(){
 const {data}=await supabase.storage.from("uploads").list("");
 const box=document.getElementById("files");
 box.innerHTML="";

 data.forEach(f=>{
  const page=`${location.origin}/file.html#${f.name}`;
  const direct=supabase.storage.from("uploads").getPublicUrl(f.name).data.publicUrl;

  box.innerHTML+=`
  <div class="file">
   <b>${f.name}</b>
   <div class="actions">
    <button class="btn-copy" onclick="copy('${page}')">Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
    <a href="${page}" target="_blank"><button class="btn-copy">ÙØªØ­</button></a>
    <button class="btn-download" onclick="download('${direct}')">ØªÙ†Ø²ÙŠÙ„</button>
    <button class="btn-delete" onclick="del('${f.name}')">Ø­Ø°Ù</button>
   </div>
  </div>`;
 });
}

function copy(t){
 navigator.clipboard.writeText(t);
 alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·");
}

function del(name){
 if(confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ù„ÙØŸ")){
  supabase.storage.from("uploads").remove([name]);
  loadFiles();
 }
}

// ØªÙ†Ø²ÙŠÙ„ Ù…Ø¹ Ù…Ø¤Ø´Ø±
function download(url){
 const a=document.createElement("a");
 a.href=url;
 a.download="";
 document.body.appendChild(a);
 a.click();
 a.remove();
}

loadFiles();
</script>
</body>
</html>
